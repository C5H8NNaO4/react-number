{"version":3,"file":"index.modern.js","sources":["../src/consts.js","../src/components/Digit.js","../src/components/Number.js"],"sourcesContent":["export const CLASSNAME_CONTAINER_NUMBER = \"react-number-container\";\r\nexport const CLASSNAME_CONTAINER_DIGIT = \"react-number-container-digit\";\r\nexport const CLASSNAME_DIGIT = \"react-number-digit\";\r\n\r\nexport const STR_EMPTY = '';\r\nexport const STR_TYPEOF_FUNCTION = 'function';\r\nexport const STR_TYPEOF_NUMBER = 'number';\r\nexport const STR_TYPEOF_STRING = 'string';\r\n\r\nexport const DEF_PARAM_NP_STRIP = 4;\r\nexport const DEF_PARAM_ANIMATE = true;","import clsx from \"clsx\";\r\nimport React from \"react\";\r\nimport { CLASSNAME_CONTAINER_DIGIT, CLASSNAME_DIGIT, STR_TYPEOF_FUNCTION } from '../consts';\r\nimport styles from '../styles.module.css';\r\n\r\n/**\r\n * Properties of the <Digit /> component\r\n * @description Test\r\n * @typedef {object} DigitProps \r\n * @property {Number} value - The digit to be displayed.\r\n * @property {Boolean} animated - Disable animation.\r\n * @property {Number} dir - Direction of the animation. -1 - down | 0 - nearest | +1 up\r\n * @property {Function} renderDigit - Render function that renders a digit.\r\n * @property {String} containerClassName - Additional className for the container\r\n * @property {String} digitClassName - Additional className for the Digit\r\n */\r\n\r\n /**\r\n  * Renders a single animated digit.\r\n  * @param {DigitProps} props \r\n  */\r\nexport const Digit = (props) => {\r\n  const { value, dir, renderDigit, digitClassName, containerClassName } = props;\r\n  const ref = React.useRef();\r\n\r\n  const [last, setLast] = React.useState(value);\r\n  const [ts, setLastTs] = React.useState(+new Date());\r\n\r\n  const children = Array.from({ length: 21 }).map((v, i) => i % 10);\r\n\r\n  React.useEffect(() => {\r\n    if (!ref.current) return;\r\n    /**@type NodeJS.Timeout */\r\n    let to;\r\n    let n = 0;\r\n\r\n    const h = ref.current.querySelector(\"span\").getBoundingClientRect().height;\r\n    const o = h * value;\r\n    const d =\r\n      0.3 *\r\n      Math.min(\r\n        Math.abs(value - (last + 10)),\r\n        Math.abs(value - last),\r\n        Math.abs(value + 10 - last)\r\n      );\r\n    if (dir < 0) {\r\n      if (value > last || last == 9) n = 10;\r\n      ref.current.style.transition = `transform 0ms`;\r\n      ref.current.style.transform = `translateY(-${h * (n + last)}px)`;\r\n\r\n      to = setTimeout(() => {\r\n        ref.current.style.transition = `transform ${d}s`;\r\n        ref.current.style.transform = `translateY(-${h * value}px)`;\r\n      }, 10);\r\n    } else if (dir > 0) {\r\n      ref.current.style.transition = `transform 0s`;\r\n      ref.current.style.transform = `translateY(-${h * last}px)`;\r\n      if (value < last) n = 10;\r\n      to = setTimeout(() => {\r\n        ref.current.style.transition = `transform ${d}s`;\r\n        ref.current.style.transform = `translateY(-${h * (n + value)}px)`;\r\n      }, 10);\r\n    } else {\r\n      ref.current.style.transition = `transform ${d}s`;\r\n      ref.current.style.transform = `translateY(-${h * value}px)`;\r\n    }\r\n\r\n    setLast(value);\r\n    setLastTs(+new Date());\r\n\r\n    return () => {\r\n      clearTimeout(to);\r\n    };\r\n  }, [value]);\r\n\r\n  const _containerclassName = clsx(styles[CLASSNAME_CONTAINER_DIGIT], containerClassName);\r\n  const _digitClassName = clsx(styles[CLASSNAME_DIGIT], digitClassName);\r\n\r\n  return (\r\n    <div className={_containerclassName} ref={ref}>\r\n      {children.map((value, index) => {\r\n        if (STR_TYPEOF_FUNCTION === typeof renderDigit) return <span className={_digitClassName}>{renderDigit({value})}</span>\r\n        return <span key={index}>{value}</span>;\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n","import React, { Fragment,useEffect, useRef, useState } from 'react';\r\nimport clsx from 'clsx';\r\n\r\n// @ts-ignore\r\nimport styles from '../styles.module.css';\r\n\r\nimport { Digit, DigitProps } from \"./Digit\";\r\nimport { CLASSNAME_CONTAINER_NUMBER, CLASSNAME_CONTAINER_DIGIT, STR_EMPTY, STR_TYPEOF_FUNCTION, STR_TYPEOF_NUMBER,STR_TYPEOF_STRING, DEF_PARAM_NP_STRIP, DEF_PARAM_ANIMATE } from '../consts';\r\n\r\nconst classNameDigit = styles[CLASSNAME_CONTAINER_DIGIT];\r\nconst classNameNumber = styles[CLASSNAME_CONTAINER_NUMBER];\r\nconst regexDigit = /\\d/;\r\nconst strSplitNumber = STR_EMPTY;\r\n\r\n/**\r\n * @typedef NumeralLibrary\r\n * @type {Function}\r\n * @description - The numeral npm package.\r\n */\r\n\r\n /**\r\n * @typedef NumberPrecisionLibrary\r\n * @type {Object}\r\n * @property {Function} strip - Function that strips IEE754 imprecision.\r\n * @description - The number-precision npm package.\r\n */\r\n\r\n\r\n/**\r\n * Displays <Numbers>.\r\n * Animated number effect as similar to the one seen on reddit. - Supports numeral library for formatting and number-precision for sanitizing input.\r\n * @param {object} props - React properties.\r\n * @param {Number} props.value - The value as number or string.\r\n * @param {function|string} props.format - A function that formats a number. - Can be a string if numeral param is set.\r\n * @param {NumeralLibrary} props.numeral - The numeral library.\r\n * @param {function|number} props.strip - Function to sanitize numerical value. Can be a number if NP param is set and will be used as the number of digits of precision to strip IEE754 floating point up to. 0.3 - 0.2 == 0.1. Needs `props.NP` set.\r\n * @param {NumberPrecisionLibrary} props.NP - The number-precision library. \r\n * @param {String} props.className - Additional className for the <Number /> component.\r\n * @param {String} props.digitClassName - Additional className for the <Digit /> component.\r\n * @param {DigitProps} props.digitProps - Additional properties passed to the Digit component.\r\n * @param {Boolean} props.animate - Enable/Disable animation.\r\n */\r\nexport const Number = (props) => {\r\n  const { value, format, numeral, NP, strip = DEF_PARAM_NP_STRIP, animate = DEF_PARAM_ANIMATE, className: numberClassName, digitClassName = 'digit', digitProps = {}} = props;\r\n\r\n  /**@type {Object} */\r\n  const ref = useRef();\r\n\r\n  const [curValue, setCurValue] = useState(value);\r\n  const [lastValue, setLastValue] = useState(value);\r\n\r\n  useEffect(() => {\r\n    setCurValue(Math.abs(value));\r\n    setLastValue(Math.abs(curValue));\r\n  }, [value]);\r\n\r\n  useEffect(() => {\r\n    const child = ref.current.querySelector(`.${classNameDigit}>span`);\r\n    if (!child)\r\n      return\r\n    console.log (\"NUMBER\", child, value)\r\n    const digitHeight = child.getBoundingClientRect().height;\r\n    ref.current.style.height = `${digitHeight}px`;\r\n  }, [ref.current]);\r\n\r\n  let sanitized = value;\r\n\r\n  // @ts-ignore\r\n  if (STR_TYPEOF_FUNCTION === typeof strip) sanitized = strip(value);\r\n\r\n  if (NP && STR_TYPEOF_NUMBER === typeof strip) {\r\n    sanitized = NP.strip(value, 2);\r\n  }\r\n\r\n  let numberStr;\r\n  \r\n  // @ts-ignore\r\n  if (STR_TYPEOF_FUNCTION === typeof format) numberStr = format(sanitized);\r\n\r\n  if (STR_TYPEOF_FUNCTION === typeof numeral && STR_TYPEOF_STRING === typeof format)\r\n    numberStr = numeral(sanitized).format(format);\r\n\r\n  numberStr = numberStr || sanitized.toString();\r\n\r\n  const len = numberStr.length;\r\n  const containerClassName = clsx(classNameNumber, numberClassName);\r\n  return (\r\n      <div ref={ref} className={containerClassName}>\r\n        {numberStr.split(strSplitNumber).map((char, index) => {\r\n          const digitKey = len - index;\r\n\r\n          if (regexDigit.test(char))\r\n            return <Digit ref={ref} key={digitKey} value={+char} dir={Math.sign(curValue - lastValue)} animate={animate} className={digitClassName} {...digitProps} />;\r\n            \r\n          if (STR_TYPEOF_FUNCTION === typeof digitProps.renderDigit)\r\n            return <span>{digitProps.renderDigit({value: char})}</span>;\r\n\r\n          return <span>{char}</span>;\r\n        })}\r\n      </div>\r\n  );\r\n};\r\n"],"names":["CLASSNAME_CONTAINER_NUMBER","CLASSNAME_CONTAINER_DIGIT","CLASSNAME_DIGIT","STR_EMPTY","STR_TYPEOF_FUNCTION","STR_TYPEOF_NUMBER","STR_TYPEOF_STRING","DEF_PARAM_NP_STRIP","DEF_PARAM_ANIMATE","Digit","props","value","dir","renderDigit","digitClassName","containerClassName","ref","React","useRef","useState","last","setLast","Date","ts","setLastTs","children","Array","from","length","map","v","i","useEffect","current","to","n","h","querySelector","getBoundingClientRect","height","d","Math","min","abs","style","transition","transform","setTimeout","clearTimeout","_containerclassName","clsx","styles","_digitClassName","index","classNameDigit","classNameNumber","regexDigit","strSplitNumber","Number","format","numeral","NP","strip","animate","numberClassName","className","digitProps","curValue","setCurValue","lastValue","setLastValue","child","console","log","digitHeight","sanitized","numberStr","toString","len","split","char","digitKey","test","sign"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAO,IAAMA,0BAA0B,GAAG,wBAAnC;AACP,AAAO,IAAMC,yBAAyB,GAAG,8BAAlC;AACP,AAAO,IAAMC,eAAe,GAAG,oBAAxB;AAEP,AAAO,IAAMC,SAAS,GAAG,EAAlB;AACP,AAAO,IAAMC,mBAAmB,GAAG,UAA5B;AACP,AAAO,IAAMC,iBAAiB,GAAG,QAA1B;AACP,AAAO,IAAMC,iBAAiB,GAAG,QAA1B;AAEP,AAAO,IAAMC,kBAAkB,GAAG,CAA3B;AACP,AAAO,IAAMC,iBAAiB,GAAG,IAA1B;;ACWA,IAAMC,KAAK,GAAG,SAARA,KAAQ,CAACC,KAAD,EAAW;AAAA,MACtBC,KADsB,GAC0CD,KAD1C,CACtBC,KADsB;AAAA,MACfC,GADe,GAC0CF,KAD1C,CACfE,GADe;AAAA,MACVC,WADU,GAC0CH,KAD1C,CACVG,WADU;AAAA,MACGC,cADH,GAC0CJ,KAD1C,CACGI,cADH;AAAA,MACmBC,kBADnB,GAC0CL,KAD1C,CACmBK,kBADnB;AAE9B,MAAMC,GAAG,GAAGC,KAAK,CAACC,MAAN,EAAZ;;AAF8B,wBAIND,KAAK,CAACE,QAAN,CAAeR,KAAf,CAJM;AAAA,MAIvBS,IAJuB;AAAA,MAIjBC,OAJiB;;AAAA,yBAKNJ,KAAK,CAACE,QAAN,CAAe,CAAC,IAAIG,IAAJ,EAAhB,CALM;AAAA,MAKvBC,AAAIC,SALmB;;AAO9B,MAAMC,QAAQ,GAAGC,KAAK,CAACC,IAAN,CAAW;AAAEC,IAAAA,MAAM,EAAE;AAAV,GAAX,EAA2BC,GAA3B,CAA+B,UAACC,CAAD,EAAIC,CAAJ;AAAA,WAAUA,CAAC,GAAG,EAAd;AAAA,GAA/B,CAAjB;AAEAd,EAAAA,KAAK,CAACe,SAAN,CAAgB,YAAM;AACpB,QAAI,CAAChB,GAAG,CAACiB,OAAT,EAAkB;AAElB,QAAIC,EAAJ;AACA,QAAIC,CAAC,GAAG,CAAR;AAEA,QAAMC,CAAC,GAAGpB,GAAG,CAACiB,OAAJ,CAAYI,aAAZ,CAA0B,MAA1B,EAAkCC,qBAAlC,GAA0DC,MAApE;AACA,AACA,QAAMC,CAAC,GACL,MACAC,IAAI,CAACC,GAAL,CACED,IAAI,CAACE,GAAL,CAAShC,KAAK,IAAIS,IAAI,GAAG,EAAX,CAAd,CADF,EAEEqB,IAAI,CAACE,GAAL,CAAShC,KAAK,GAAGS,IAAjB,CAFF,EAGEqB,IAAI,CAACE,GAAL,CAAShC,KAAK,GAAG,EAAR,GAAaS,IAAtB,CAHF,CAFF;;AAOA,QAAIR,GAAG,GAAG,CAAV,EAAa;AACX,UAAID,KAAK,GAAGS,IAAR,IAAgBA,IAAI,IAAI,CAA5B,EAA+Be,CAAC,GAAG,EAAJ;AAC/BnB,MAAAA,GAAG,CAACiB,OAAJ,CAAYW,KAAZ,CAAkBC,UAAlB;AACA7B,MAAAA,GAAG,CAACiB,OAAJ,CAAYW,KAAZ,CAAkBE,SAAlB,oBAA6CV,CAAC,IAAID,CAAC,GAAGf,IAAR,CAA9C;AAEAc,MAAAA,EAAE,GAAGa,UAAU,CAAC,YAAM;AACpB/B,QAAAA,GAAG,CAACiB,OAAJ,CAAYW,KAAZ,CAAkBC,UAAlB,kBAA4CL,CAA5C;AACAxB,QAAAA,GAAG,CAACiB,OAAJ,CAAYW,KAAZ,CAAkBE,SAAlB,oBAA6CV,CAAC,GAAGzB,KAAjD;AACD,OAHc,EAGZ,EAHY,CAAf;AAID,KATD,MASO,IAAIC,GAAG,GAAG,CAAV,EAAa;AAClBI,MAAAA,GAAG,CAACiB,OAAJ,CAAYW,KAAZ,CAAkBC,UAAlB;AACA7B,MAAAA,GAAG,CAACiB,OAAJ,CAAYW,KAAZ,CAAkBE,SAAlB,oBAA6CV,CAAC,GAAGhB,IAAjD;AACA,UAAIT,KAAK,GAAGS,IAAZ,EAAkBe,CAAC,GAAG,EAAJ;AAClBD,MAAAA,EAAE,GAAGa,UAAU,CAAC,YAAM;AACpB/B,QAAAA,GAAG,CAACiB,OAAJ,CAAYW,KAAZ,CAAkBC,UAAlB,kBAA4CL,CAA5C;AACAxB,QAAAA,GAAG,CAACiB,OAAJ,CAAYW,KAAZ,CAAkBE,SAAlB,oBAA6CV,CAAC,IAAID,CAAC,GAAGxB,KAAR,CAA9C;AACD,OAHc,EAGZ,EAHY,CAAf;AAID,KARM,MAQA;AACLK,MAAAA,GAAG,CAACiB,OAAJ,CAAYW,KAAZ,CAAkBC,UAAlB,kBAA4CL,CAA5C;AACAxB,MAAAA,GAAG,CAACiB,OAAJ,CAAYW,KAAZ,CAAkBE,SAAlB,oBAA6CV,CAAC,GAAGzB,KAAjD;AACD;;AAEDU,IAAAA,OAAO,CAACV,KAAD,CAAP;AACAa,IAAAA,SAAS,CAAC,CAAC,IAAIF,IAAJ,EAAF,CAAT;AAEA,WAAO,YAAM;AACX0B,MAAAA,YAAY,CAACd,EAAD,CAAZ;AACD,KAFD;AAGD,GA3CD,EA2CG,CAACvB,KAAD,CA3CH;;AA6CA,MAAMsC,mBAAmB,GAAGC,IAAI,CAACC,MAAM,CAAClD,yBAAD,CAAP,EAAoCc,kBAApC,CAAhC;;AACA,MAAMqC,eAAe,GAAGF,IAAI,CAACC,MAAM,CAACjD,eAAD,CAAP,EAA0BY,cAA1B,CAA5B;;AAEA,sBACE;AAAK,IAAA,SAAS,EAAEmC,mBAAhB;AAAqC,IAAA,GAAG,EAAEjC;AAA1C,KACGS,QAAQ,CAACI,GAAT,CAAa,UAAClB,KAAD,EAAQ0C,KAAR,EAAkB;AAC9B,QAAIjD,mBAAmB,KAAK,OAAOS,WAAnC,EAAgD,oBAAO;AAAM,MAAA,SAAS,EAAEuC;AAAjB,OAAmCvC,WAAW,CAAC;AAACF,MAAAA,KAAK,EAALA;AAAD,KAAD,CAA9C,CAAP;AAChD,wBAAO;AAAM,MAAA,GAAG,EAAE0C;AAAX,OAAmB1C,KAAnB,CAAP;AACD,GAHA,CADH,CADF;AAQD,CAjEM;;ACZP,IAAM2C,cAAc,GAAGH,MAAM,CAAClD,yBAAD,CAA7B;AACA,IAAMsD,eAAe,GAAGJ,MAAM,CAACnD,0BAAD,CAA9B;AACA,IAAMwD,UAAU,GAAG,IAAnB;AACA,IAAMC,cAAc,GAAGtD,SAAvB;AA8BA,IAAauD,MAAM,GAAG,SAATA,MAAS,CAAChD,KAAD,EAAW;AAAA,MACvBC,KADuB,GACuID,KADvI,CACvBC,KADuB;AAAA,MAChBgD,MADgB,GACuIjD,KADvI,CAChBiD,MADgB;AAAA,MACRC,OADQ,GACuIlD,KADvI,CACRkD,OADQ;AAAA,MACCC,EADD,GACuInD,KADvI,CACCmD,EADD;AAAA,qBACuInD,KADvI,CACKoD,KADL;AAAA,MACKA,KADL,6BACavD,kBADb;AAAA,uBACuIG,KADvI,CACiCqD,OADjC;AAAA,MACiCA,OADjC,+BAC2CvD,iBAD3C;AAAA,MACyEwD,eADzE,GACuItD,KADvI,CAC8DuD,SAD9D;AAAA,8BACuIvD,KADvI,CAC0FI,cAD1F;AAAA,MAC0FA,cAD1F,sCAC2G,OAD3G;AAAA,0BACuIJ,KADvI,CACoHwD,UADpH;AAAA,MACoHA,UADpH,kCACiI,EADjI;AAI/B,MAAMlD,GAAG,GAAGE,MAAM,EAAlB;;AAJ+B,kBAMCC,QAAQ,CAACR,KAAD,CANT;AAAA,MAMxBwD,QANwB;AAAA,MAMdC,WANc;;AAAA,mBAOGjD,QAAQ,CAACR,KAAD,CAPX;AAAA,MAOxB0D,SAPwB;AAAA,MAObC,YAPa;;AAS/BtC,EAAAA,SAAS,CAAC,YAAM;AACdoC,IAAAA,WAAW,CAAC3B,IAAI,CAACE,GAAL,CAAShC,KAAT,CAAD,CAAX;AACA2D,IAAAA,YAAY,CAAC7B,IAAI,CAACE,GAAL,CAASwB,QAAT,CAAD,CAAZ;AACD,GAHQ,EAGN,CAACxD,KAAD,CAHM,CAAT;AAKAqB,EAAAA,SAAS,CAAC,YAAM;AACd,QAAMuC,KAAK,GAAGvD,GAAG,CAACiB,OAAJ,CAAYI,aAAZ,OAA8BiB,cAA9B,WAAd;AACA,QAAI,CAACiB,KAAL,EACE;AACFC,IAAAA,OAAO,CAACC,GAAR,CAAa,QAAb,EAAuBF,KAAvB,EAA8B5D,KAA9B;AACA,QAAM+D,WAAW,GAAGH,KAAK,CAACjC,qBAAN,GAA8BC,MAAlD;AACAvB,IAAAA,GAAG,CAACiB,OAAJ,CAAYW,KAAZ,CAAkBL,MAAlB,GAA8BmC,WAA9B;AACD,GAPQ,EAON,CAAC1D,GAAG,CAACiB,OAAL,CAPM,CAAT;AASA,MAAI0C,SAAS,GAAGhE,KAAhB;AAGA,MAAIP,mBAAmB,KAAK,OAAO0D,KAAnC,EAA0Ca,SAAS,GAAGb,KAAK,CAACnD,KAAD,CAAjB;;AAE1C,MAAIkD,EAAE,IAAIxD,iBAAiB,KAAK,OAAOyD,KAAvC,EAA8C;AAC5Ca,IAAAA,SAAS,GAAGd,EAAE,CAACC,KAAH,CAASnD,KAAT,EAAgB,CAAhB,CAAZ;AACD;;AAED,MAAIiE,SAAJ;AAGA,MAAIxE,mBAAmB,KAAK,OAAOuD,MAAnC,EAA2CiB,SAAS,GAAGjB,MAAM,CAACgB,SAAD,CAAlB;AAE3C,MAAIvE,mBAAmB,KAAK,OAAOwD,OAA/B,IAA0CtD,iBAAiB,KAAK,OAAOqD,MAA3E,EACEiB,SAAS,GAAGhB,OAAO,CAACe,SAAD,CAAP,CAAmBhB,MAAnB,CAA0BA,MAA1B,CAAZ;AAEFiB,EAAAA,SAAS,GAAGA,SAAS,IAAID,SAAS,CAACE,QAAV,EAAzB;AAEA,MAAMC,GAAG,GAAGF,SAAS,CAAChD,MAAtB;AACA,MAAMb,kBAAkB,GAAGmC,IAAI,CAACK,eAAD,EAAkBS,eAAlB,CAA/B;AACA,sBACI;AAAK,IAAA,GAAG,EAAEhD,GAAV;AAAe,IAAA,SAAS,EAAED;AAA1B,KACG6D,SAAS,CAACG,KAAV,CAAgBtB,cAAhB,EAAgC5B,GAAhC,CAAoC,UAACmD,KAAD,EAAO3B,KAAP,EAAiB;AACpD,QAAM4B,QAAQ,GAAGH,GAAG,GAAGzB,KAAvB;AAEA,QAAIG,UAAU,CAAC0B,IAAX,CAAgBF,KAAhB,CAAJ,EACE,oBAAO,oBAAC,KAAD;AAAO,MAAA,GAAG,EAAEhE,GAAZ;AAAiB,MAAA,GAAG,EAAEiE,QAAtB;AAAgC,MAAA,KAAK,EAAE,CAACD,KAAxC;AAA8C,MAAA,GAAG,EAAEvC,IAAI,CAAC0C,IAAL,CAAUhB,QAAQ,GAAGE,SAArB,CAAnD;AAAoF,MAAA,OAAO,EAAEN,OAA7F;AAAsG,MAAA,SAAS,EAAEjD;AAAjH,OAAqIoD,UAArI,EAAP;AAEF,QAAI9D,mBAAmB,KAAK,OAAO8D,UAAU,CAACrD,WAA9C,EACE,oBAAO,kCAAOqD,UAAU,CAACrD,WAAX,CAAuB;AAACF,MAAAA,KAAK,EAAEqE;AAAR,KAAvB,CAAP,CAAP;AAEF,wBAAO,kCAAOA,KAAP,CAAP;AACD,GAVA,CADH,CADJ;AAeD,CA3DM;;;;"}